[32m2025-12-20 22:47:58 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9d81e72a-4101-476e-be80-7fd2722d2dcc - 1247714 - LOGS_CAPTURED - Started capturing logs in process (pid: 1247714).
[32m2025-12-20 22:47:58 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 9d81e72a-4101-476e-be80-7fd2722d2dcc - 1247714 - fact_ohlcv_kraken_eth_1m - STEP_START - Started execution of step "fact_ohlcv_kraken_eth_1m".
[32m2025-12-20 22:47:58 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 9d81e72a-4101-476e-be80-7fd2722d2dcc - fact_ohlcv_kraken_eth_1m - Processing window: 2025-12-20 21:00:00+00:00 â†’ 2025-12-20 22:00:00+00:00
[32m2025-12-20 22:47:59 +0000[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 9d81e72a-4101-476e-be80-7fd2722d2dcc - 1247714 - fact_ohlcv_kraken_eth_1m - STEP_FAILURE - Execution of step "fact_ohlcv_kraken_eth_1m" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "fact_ohlcv_kraken_eth_1m"::

google.api_core.exceptions.Forbidden: 403 GET https://bigquery.googleapis.com/bigquery/v2/projects/kline-pipeline/queries/99ca72c6-a383-493e-a469-9c28e3dd8223?maxResults=0&location=US&prettyPrint=false: Access Denied: BigQuery BigQuery: Permission denied while globbing file pattern. dagster-bq-runner@kline-pipeline.iam.gserviceaccount.com does not have storage.objects.list access to the Google Cloud Storage bucket. Permission 'storage.objects.list' denied on resource (or it may not exist). Please make sure gs://kline-pipeline-bronze/* is accessible via appropriate IAM roles, e.g. Storage Object Viewer or Storage Object Creator.

Location: US
Job ID: 99ca72c6-a383-493e-a469-9c28e3dd8223


Stack Trace:
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/kline_pipeline/kline_pipeline/assets.py", line 137, in fact_ohlcv_kraken_eth_1m
    job.result()
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1773, in result
    while not is_job_done():
              ^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1742, in is_job_done
    self._reload_query_results(retry=retry, **reload_query_results_kwargs)
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1534, in _reload_query_results
    self._query_results = self._client._get_query_results(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2113, in _get_query_results
    resource = self._call_api(
               ^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
[0m
