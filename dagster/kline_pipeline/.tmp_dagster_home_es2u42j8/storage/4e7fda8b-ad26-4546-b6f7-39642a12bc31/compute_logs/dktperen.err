[32m2025-12-21 02:53:11 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 4e7fda8b-ad26-4546-b6f7-39642a12bc31 - 1482629 - LOGS_CAPTURED - Started capturing logs in process (pid: 1482629).
[32m2025-12-21 02:53:11 +0000[0m - dagster - [34mDEBUG[0m - __ASSET_JOB - 4e7fda8b-ad26-4546-b6f7-39642a12bc31 - 1482629 - fact_ohlcv_kraken_eth_1m - STEP_START - Started execution of step "fact_ohlcv_kraken_eth_1m".
[32m2025-12-21 02:53:11 +0000[0m - dagster - [34mINFO[0m - __ASSET_JOB - 4e7fda8b-ad26-4546-b6f7-39642a12bc31 - fact_ohlcv_kraken_eth_1m - Silver merge Kraken ETH-USD | 2025-12-21 01:00:00 â†’ 2025-12-21 02:00:00
[32m2025-12-21 02:53:12 +0000[0m - dagster - [34mERROR[0m - [31m__ASSET_JOB - 4e7fda8b-ad26-4546-b6f7-39642a12bc31 - 1482629 - fact_ohlcv_kraken_eth_1m - STEP_FAILURE - Execution of step "fact_ohlcv_kraken_eth_1m" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "fact_ohlcv_kraken_eth_1m"::

google.api_core.exceptions.BadRequest: 400 GET https://bigquery.googleapis.com/bigquery/v2/projects/kline-pipeline/queries/af993cdb-73a7-4976-a576-1f0124d832ca?maxResults=0&location=US&prettyPrint=false: UPDATE/MERGE must match at most one source row for each target row

Location: US
Job ID: af993cdb-73a7-4976-a576-1f0124d832ca


Stack Trace:
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_core/execution/plan/utils.py", line 57, in op_execution_error_boundary
    yield
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_utils/__init__.py", line 394, in iterate_with_context
    next_output = next(iterator)
                  ^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 135, in _coerce_op_compute_fn_to_iterator
    result = invoke_compute_fn(
             ^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/dagster/_core/execution/plan/compute_generator.py", line 115, in invoke_compute_fn
    return fn(context, **args_to_pass) if context_arg_provided else fn(**args_to_pass)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/kline_pipeline/kline_pipeline/assets_silver.py", line 135, in fact_ohlcv_kraken_eth_1m
    job.result()
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1773, in result
    while not is_job_done():
              ^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1742, in is_job_done
    self._reload_query_results(retry=retry, **reload_query_results_kwargs)
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/job/query.py", line 1534, in _reload_query_results
    self._query_results = self._client._get_query_results(
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 2113, in _get_query_results
    resource = self._call_api(
               ^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/bigquery/client.py", line 861, in _call_api
    return call()
           ^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 294, in retry_wrapped_func
    return retry_target(
           ^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 156, in retry_target
    next_sleep = _retry_error_helper(
                 ^^^^^^^^^^^^^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_base.py", line 214, in _retry_error_helper
    raise final_exc from source_exc
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/api_core/retry/retry_unary.py", line 147, in retry_target
    result = target()
             ^^^^^^^^
  File "/home/ubuntu/dagster/dagster-env/lib/python3.12/site-packages/google/cloud/_http/__init__.py", line 494, in api_request
    raise exceptions.from_http_response(response)
[0m
